
pipeline {
    agent any
    
    tools {
        maven  'maven-3.9'
    }
    stages {
        stage("build jar") {
            steps {
                echo "building application ..."
                sh 'mvn package'
            }
        }
        stage("build image") {
            steps {
                echo "build image ..."
                withCredentials([usernamePassword(credentialsId:'docker-hub-repo' , usernameVariable:'USER', passwordVariable:'PASS')]){
                  sh 'docker build -t bembemed/demo-app:jma-2.0 .'
                  sh "echo $PASS | docker login -u $USER -p --password-stdin"
                  sh "docker push bembemed/demo-app:jma-2.0 "
            }
            
        }  
        
    } 
}
}
